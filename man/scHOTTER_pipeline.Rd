% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/pipeline.R
\name{scHOTTER_pipeline}
\alias{scHOTTER_pipeline}
\title{End-to-end pipeline: local co-expression p-values (stores intermediates)}
\usage{
scHOTTER_pipeline(
  expr,
  span = NULL,
  kernel_type = c("block", "gaussian"),
  fisher_transform = TRUE,
  drop_zero_weight = TRUE
)
}
\arguments{
\item{expr}{Numeric matrix (\eqn{\text{points} \times  \text{genes}}). \strong{Row names must contain}
"x y" coordinates separated by \code{x}, \verb{_}, \verb{,}, or whitespace (e.g. \code{"10.2_5.7"}).
Column names are gene symbols.}

\item{span}{Optional numeric in (0,1]; target proportion of points per kernel
(passed to kernel generation and weighting). Default uses the package
heuristic if \code{NULL}.}

\item{kernel_type}{\code{"block"} or \code{"gaussian"}; passed to
\code{\link[=generate_weight_matrix_euclidean]{generate_weight_matrix_euclidean()}}.}

\item{fisher_transform}{Logical; Fisher-transform local correlations (\code{atanh}).
Must be \code{TRUE} to match downstream variance formulas (default \code{TRUE}).}

\item{drop_zero_weight}{Logical; restrict each kernel's correlation to rows
with \code{w>0} for that kernel (default \code{TRUE}).}
}
\value{
A list with:
\itemize{
\item \code{p_values}: named numeric vector of p-values (one per gene pair).
\item \code{summary}: data.frame with columns \code{pair}, \code{s2}, \code{z}, \code{p}.
\item \code{intermediates}: a list containing
\code{coords}, \code{centres}, \code{weight_matrix_initial}, \code{membership},
\code{overlaps}, \code{light_kernels}, \code{weight_matrix}, \code{local_corr_matrix},
\code{neff}, \code{corr}, \code{sigma}, \code{expectation}, \code{variance},
\code{s2}, \code{z_scores}, \code{p_values}.
\item \code{params}: the input parameters actually used.
}
}
\description{
Takes a gene expression matrix whose \strong{rownames encode coordinates}
(e.g. "12.3x45.6", "12.3_45.6", "12.3,45.6", or "12.3 45.6") and returns one-sided
upper-tail p-values for the standardized sample-variance statistic of
kernel-wise Fisher z correlations, \emph{plus} all intermediate objects.
}
\examples{
set.seed(1)
n <- 80
coords <- cbind(runif(n, 0, 10), runif(n, 0, 5))
rn <- apply(coords, 1, function(v) paste0(v[1], "_", v[2]))
expr <- cbind(g1 = rnorm(n), g2 = rnorm(n), g3 = rnorm(n))
rownames(expr) <- rn
out <- scHOTTER_pipeline(expr, span = 0.2, kernel_type = "gaussian")
head(out$summary)

}
