% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/standardise_test_statistics.R
\name{compute_test_statistics_standardised_effective}
\alias{compute_test_statistics_standardised_effective}
\title{Standardize sample-variance test statistics into Z-scores}
\usage{
compute_test_statistics_standardised_effective(
  variances,
  expectations,
  vars_of_local_corrs
)
}
\arguments{
\item{variances}{Numeric scalar or vector: \eqn{\mathrm{Var}(S^2)} under the null.
Typically the scalar output of \code{approximate_variance_effective(Sigma)}.
Can also be a named vector matching \code{vars_of_local_corrs}.}

\item{expectations}{Numeric scalar or vector: \eqn{\mathbb{E}[S^2]} under the null.
Typically the scalar output of \code{approximate_expectation_effective(Sigma)}.
Can also be a named vector matching \code{vars_of_local_corrs}.}

\item{vars_of_local_corrs}{Named numeric vector: observed sample variances
(one per gene pair), e.g. from \code{compute_var_of_local_corrs()}.}
}
\value{
A named numeric vector of Z-scores aligned with
\code{names(vars_of_local_corrs)}. Entries with non-finite or non-positive
variances are returned as \code{NA_real_}.
}
\description{
Converts the raw sample variance of local Fisher z correlations
(one value per gene pair) into standardized Z-scores using the
null mean and variance derived from the kernel dependence structure. The resulting
standardised statistic is distributed approximately according to the standard
Normal distribution.
}
\examples{
# Simple algebraic example
s2  <- c(a_b = 3, a_c = 5, b_c = 4)
mu  <- 4      # E[S^2]
var <- 1.0    # Var(S^2)
compute_test_statistics_standardised_effective(var, mu, s2)

}
