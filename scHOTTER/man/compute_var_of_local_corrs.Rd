% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/compute_var_of_local_corrs.R
\name{compute_var_of_local_corrs}
\alias{compute_var_of_local_corrs}
\title{Sample variance of kernel-wise Fisher z per gene pair}
\usage{
compute_var_of_local_corrs(local_corr_matrix)
}
\arguments{
\item{local_corr_matrix}{Numeric matrix with rows = kernels and columns =
gene-pair labels (e.g., from \code{get_local_correlation_matrix()} with
\code{fisher_transform = TRUE}).}
}
\value{
A named numeric vector of length \code{ncol(local_corr_matrix)}
containing the sample variance for each gene pair.
}
\description{
Given a matrix of local Fisher z correlations (rows = kernels, columns = gene
pairs like \code{"GENE1_GENE2"}), compute the unbiased sample variance
\eqn{S^2} down each column, ignoring \code{NA}s. Columns with fewer than two
finite values return \code{NA_real_}.
}
\examples{
set.seed(1)
expr <- cbind(a = rnorm(60), b = rnorm(60), c = rnorm(60))
coords <- cbind(runif(60), runif(60))
centres <- generate_kernel_centres_by_density(coords, span = 0.2)
W <- generate_weight_matrix_euclidean(coords, centres, span = 0.2, type = "gaussian")
Z <- get_local_correlation_matrix(expr, W, fisher_transform = TRUE)
s2 <- compute_var_of_local_corrs(Z)
head(s2)

}
